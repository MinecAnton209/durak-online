<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="document_title">–ì—Ä–∞ –î—É—Ä–µ–Ω—å –û–Ω–ª–∞–π–Ω</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://unpkg.com/i18next/i18next.js"></script>
    <script src="https://unpkg.com/i18next-browser-languagedetector/i18nextBrowserLanguageDetector.js"></script>
</head>

<body>
    <div id="maintenance-banner" class="maintenance-banner" style="display: none;">
        <span id="maintenance-banner-message"></span>
        <span id="maintenance-banner-countdown"></span>
    </div>
    <div class="lang-switcher">
        <button class="lang-btn" data-lang="uk">üá∫üá¶</button>
        <button class="lang-btn" data-lang="en">üá¨üáß</button>
    </div>

    <div id="welcome-screen">
        <h1 data-i18n="welcome_title">–î—É—Ä–µ–Ω—å –û–Ω–ª–∞–π–Ω</h1>
        <div id="user-profile" style="display: none;">
            <p><span data-i18n="profile_greeting">–í–∏ —É–≤—ñ–π—à–ª–∏ —è–∫</span> <strong id="profile-username"></strong></p>
            <div class="stats">
                <span><span data-i18n="profile_wins">üèÜ –ü–µ—Ä–µ–º–æ–≥:</span> <b id="profile-wins">0</b></span>
                <span><span data-i18n="profile_losses">üíî –ü–æ—Ä–∞–∑–æ–∫:</span> <b id="profile-losses">0</b></span>
            </div>
            <div class="profile-actions">
                <button id="leaderboardBtnUser" class="secondary-btn icon-btn" data-i18n="leaderboard_button">üèÜ
                    –õ—ñ–¥–µ—Ä–±–æ—Ä–¥–∏</button>
                <button id="achievementsBtn" class="secondary-btn icon-btn" data-i18n="achievements_button">üèÜ
                    –î–æ—Å—è–≥–Ω–µ–Ω–Ω—è</button>
                <button id="friendsBtn" class="secondary-btn icon-btn" data-i18n="friends_button">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18" style="vertical-align: middle;">
                        <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
                    </svg>
                    <span data-i18n="friends_button_text">–î—Ä—É–∑—ñ</span>
                </button>
                <a href="/settings"><button class="secondary-btn" data-i18n="settings_button">–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</button></a>
                <button id="logoutBtn" class="secondary-btn" data-i18n="logout_button">–í–∏–π—Ç–∏</button>
            </div>
        </div>
        <div id="guest-login">
            <div class="auth-buttons">
                <button id="showLoginBtn" class="secondary-btn" data-i18n="login_button">–í—Ö—ñ–¥</button>
                <button id="showRegisterBtn" class="secondary-btn" data-i18n="register_button">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</button>
            </div>
            <div class="guest-actions">
                <button id="leaderboardBtnGuest" class="secondary-btn" data-i18n="leaderboard_button">üèÜ
                    –õ—ñ–¥–µ—Ä–±–æ—Ä–¥–∏</button>
            </div>
            <p class="separator"><span data-i18n="or_separator">–ê–ë–û</span></p>
            <div class="settings-form">
                <div class="form-group">
                    <label for="playerNameInput" data-i18n="guest_name_label">–í–∞—à–µ —ñ–º'—è (—è–∫ –≥–æ—Å—Ç—è):</label>
                    <input type="text" id="playerNameInput" placeholder="–ì—Ä–∞–≤–µ—Ü—å 1">
                </div>
            </div>
        </div>
        <div id="game-creation-controls">
            <div class="settings-form">
                <div class="form-group"><label for="deckSize" data-i18n="deck_size_label">–†–æ–∑–º—ñ—Ä –∫–æ–ª–æ–¥–∏:</label><select
                        id="deckSize">
                        <option value="36" data-i18n="deck_36">36 –∫–∞—Ä—Ç</option>
                        <option value="52" data-i18n="deck_52">52 –∫–∞—Ä—Ç–∏</option>
                        <option value="24" data-i18n="deck_24">24 –∫–∞—Ä—Ç–∏</option>
                    </select></div>
                <div class="form-group"><label for="maxPlayers" data-i18n="players_count_label">–ö—ñ–ª—å–∫—ñ—Å—Ç—å
                        –≥—Ä–∞–≤—Ü—ñ–≤:</label><select id="maxPlayers">
                        <option value="2" data-i18n="players_2">2 –≥—Ä–∞–≤—Ü—ñ</option>
                        <option value="3" data-i18n="players_3">3 –≥—Ä–∞–≤—Ü—ñ</option>
                        <option value="4" data-i18n="players_4">4 –≥—Ä–∞–≤—Ü—ñ</option>
                    </select></div>
                <div class="form-group"><label for="customGameId" data-i18n="custom_link_label">–°–≤–æ—î –ø–æ—Å–∏–ª–∞–Ω–Ω—è
                        (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ):</label><input type="text" id="customGameId" placeholder="MY-COOL-GAME"></div>
                <button id="createGameBtn" data-i18n="create_game_button">–°—Ç–≤–æ—Ä–∏—Ç–∏ –≥—Ä—É</button>
            </div>
            <div id="join-game-section" style="display: none;">
                <p data-i18n="join_game_prompt">–ü—Ä–∏—î–¥–Ω–∞–π—Ç–µ—Å—å –¥–æ –≥—Ä–∏ –¥—Ä—É–≥–∞:</p><button id="joinGameBtn"
                    data-i18n="join_button">–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—å</button>
            </div>
        </div>
        <p id="error-message" class="error"></p>
    </div>

    <div id="lobby-screen" style="display: none;">
        <h2><span data-i18n="lobby_title">–ö—ñ–º–Ω–∞—Ç–∞:</span> <span id="lobbyGameId"></span></h2>
        <p data-i18n="lobby_invite_link">–ü–æ—Å–∏–ª–∞–Ω–Ω—è –¥–ª—è –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—è:</p>
        <div class="invite-link-wrapper"><input type="text" id="lobbyInviteLink" readonly>
            <div id="copyLobbyLinkBtn" class="copy-icon-btn" title="–ö–æ–ø—ñ—é–≤–∞—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è"><svg
                    xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg></div>
        </div>
        <button id="friendsBtnLobby" class="secondary-btn icon-btn" data-i18n="friends_button">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18" style="vertical-align: middle;">
                <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
            </svg>
            <span data-i18n="friends_button_text">–î—Ä—É–∑—ñ</span>
        </button>
        <hr>
        <h3 data-i18n="lobby_players_title">–ì—Ä–∞–≤—Ü—ñ –≤ –∫—ñ–º–Ω–∞—Ç—ñ:</h3>
        <ul id="player-list"></ul>
        <p id="lobby-status"></p>
        <div id="host-controls" style="display: none;"><button id="startGameBtn" disabled></button></div>
    </div>

    <div id="game-screen" style="display: none;">
        <button id="leaveGameBtn" class="leave-btn">üö™ <span data-i18n="leave_game_button">–í–∏–π—Ç–∏</span></button>
        <button id="music-panel-toggle-btn" class="floating-btn music-btn" title="–ú—É–∑–∏–∫–∞">üéµ</button>

        <div class="game-header">
            <div class="invite-link-wrapper"><input type="text" id="inviteLink" readonly>
                <div id="copyLinkBtn" class="copy-icon-btn" title="–ö–æ–ø—ñ—é–≤–∞—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è"><svg
                        xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                    </svg></div>
            </div>
        </div>
        <div id="opponents-container"></div>
        <div id="game-log-container">
            <div class="log-header">
                <h4 data-i18n="log_title">–ñ—É—Ä–Ω–∞–ª / –ß–∞—Ç</h4>
                <button id="toggle-chat-btn" class="toggle-chat-btn" title="–ó–≥–æ—Ä–Ω—É—Ç–∏/—Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </button>
                <span id="close-log-btn" class="close-log-btn">√ó</span>
            </div>
            <ul id="game-log-list"></ul>
            <form id="chat-form"><input type="text" id="chat-input" data-i18n-placeholder="chat_placeholder"
                    autocomplete="off"><button type="submit">‚û§</button></form>
        </div>
        <button id="show-log-btn-mobile" class="floating-btn">üìú</button>
        <div id="deck-area">
            <div id="deck-pile-visual">
                <div class="card card-back"></div><span id="deck-count-display">?</span>
            </div>
        </div>
        <div id="table-area">
            <div id="game-info-bar"><span id="trump-card-display">–ö–æ–∑–∏—Ä: ?</span></div>
            <p id="turn-status" class="turn-status"></p>
            <div id="game-table" class="card-hand"></div>
            <div id="action-buttons"></div>
        </div>
        <div id="player-area" class="player-area">
            <h3><span data-i18n="you_are_player">–í–∏:</span> <span id="playerName"></span></h3>
            <div id="player-cards" class="card-hand"></div>
        </div>

        <div id="music-panel" class="music-panel" style="display: none;">
            <div class="music-panel-header">
                <h4>–ú—É–∑–∏–∫–∞ –≤ –∫—ñ–º–Ω–∞—Ç—ñ</h4>
                <span id="close-music-panel-btn" class="close-panel-btn">√ó</span>
            </div>
            <div class="music-panel-body">
                <div id="current-track-info">
                    <strong>–ó–∞—Ä–∞–∑ –≥—Ä–∞—î:</strong> <span id="track-title-display">–¢–∏—à–∞...</span><br>
                    <small>–ó–∞–ø—Ä–æ–ø–æ–Ω—É–≤–∞–≤: <span id="suggester-display">–Ω—ñ—Ö—Ç–æ</span></small>
                </div>
                <hr>
                <div id="host-music-controls" style="display: none;">
                    <label for="youtube-url-input">–í—Å—Ç–∞–≤—Ç–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ YouTube:</label>
                    <input type="text" id="youtube-url-input" placeholder="https://www.youtube.com/watch?v=...">
                    <button id="change-track-btn">–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Ç—Ä–µ–∫</button>
                    <div class="playback-controls">
                        <button id="toggle-playback-btn">‚ñ∂Ô∏è</button>
                        <input type="range" id="volume-slider" min="0" max="100" value="50">
                    </div>
                    <hr>
                    <div class="track-progress">
                        <div class="time-display" id="current-time-display">
                            <span class="minutes">0</span>
                            <span>:</span>
                            <div class="digit-container">
                                <span class="digit-reel" id="secs-tens"></span>
                            </div>
                            <div class="digit-container">
                                <span class="digit-reel" id="secs-ones"></span>
                            </div>
                        </div>
                        <span class="time-separator">/</span>
                        <span class="time-display" id="duration-display">0:00</span>
                    </div>
                    <div id="suggestions-list-container">
                        <h5>–ü—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó –≤—ñ–¥ –≥—Ä–∞–≤—Ü—ñ–≤:</h5>
                        <ul id="suggestions-list"></ul>
                    </div>
                </div>

                <div id="guest-music-controls" style="display: none;">
                    <label for="suggest-url-input">–ó–∞–ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏ —Ç—Ä–µ–∫ (YouTube):</label>
                    <input type="text" id="suggest-url-input" placeholder="https://www.youtube.com/watch?v=...">
                    <button id="suggest-track-btn">–ó–∞–ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏</button>
                </div>
            </div>
            <div id="guest-music-controls">
            </div>
        </div>
    </div>
    </div>

    <div id="winner-screen" style="display: none;">
        <h2 id="winner-message"></h2>
        <button id="rematchBtn" data-i18n="rematch_button">–†–µ–≤–∞–Ω—à</button>
        <p id="rematch-status"></p>
        <a href="/"><button class="secondary-btn" data-i18n="exit_to_menu_button">–í–∏–π—Ç–∏ –≤ –≥–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é</button></a>
    </div>

    <div id="center-animation-container"></div>
    <div id="error-toast"></div>

    <div id="auth-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <span class="close-modal-btn">√ó</span>
            <h2 id="modal-title"></h2>
            <form id="auth-form">
                <div class="form-group"><label for="authUsername" data-i18n="username_label">–Ü–º'—è
                        –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:</label><input type="text" id="authUsername" required></div>
                <div class="form-group"><label for="authPassword" data-i18n="password_label">–ü–∞—Ä–æ–ª—å:</label><input
                        type="password" id="authPassword" required></div>
                <p id="auth-error" class="error"></p>
                <button type="submit" id="authSubmitBtn"></button>
            </form>
        </div>
    </div>

    <div id="achievements-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content large">
            <span id="close-achievements-modal-btn" class="close-modal-btn">√ó</span>
            <h2 data-i18n="achievements_modal_title">–î–æ—Å—è–≥–Ω–µ–Ω–Ω—è</h2>
            <div id="achievements-list" class="achievements-grid"></div>
        </div>
    </div>

    <div id="leaderboard-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content large">
            <span id="close-leaderboard-modal-btn" class="close-modal-btn">√ó</span>
            <h2 data-i18n="leaderboard_modal_title">–õ—ñ–¥–µ—Ä–±–æ—Ä–¥–∏</h2>
            <div class="tabs">
                <button class="tab-link active" data-type="rating" data-i18n="leaderboard_tab_rating">–ó–∞
                    –†–µ–π—Ç–∏–Ω–≥–æ–º</button>
                <button class="tab-link" data-type="wins" data-i18n="leaderboard_tab_wins">–ó–∞ –ü–µ—Ä–µ–º–æ–≥–∞–º–∏</button>
                <button class="tab-link" data-type="win_streak" data-i18n="leaderboard_tab_win_streak">–ó–∞ –°–µ—Ä—ñ—î—é
                    –ü–µ—Ä–µ–º–æ–≥</button>
            </div>
            <div id="leaderboard-content"></div>
        </div>
    </div>

    <div id="friends-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content large">
            <span id="close-friends-modal-btn" class="close-modal-btn">√ó</span>
            <h2 data-i18n="friends_modal_title">–î—Ä—É–∑—ñ</h2>

            <div class="tabs">
                <button class="tab-link active" data-tab="friends-list-tab" data-i18n="friends_tab_friends">–ú–æ—ó –¥—Ä—É–∑—ñ</button>
                <button class="tab-link" data-tab="incoming-requests-tab" data-i18n="friends_tab_incoming">–í—Ö—ñ–¥–Ω—ñ –∑–∞–ø–∏—Ç–∏ <span id="incoming-requests-count" class="notification-badge" style="display: none;"></span></button>
                <button class="tab-link" data-tab="outgoing-requests-tab" data-i18n="friends_tab_outgoing">–í–∏—Ö—ñ–¥–Ω—ñ –∑–∞–ø–∏—Ç–∏</button>
                <button class="tab-link" data-tab="add-friend-tab" data-i18n="friends_tab_add">–ó–Ω–∞–π—Ç–∏ –¥—Ä—É–∑—ñ–≤</button>
            </div>

            <div id="friends-list-tab" class="tab-content active">
                <ul id="friends-list" class="user-list">
                    <p class="empty-list-placeholder" data-i18n="friends_list_empty">–£ –≤–∞—Å –ø–æ–∫–∏ –Ω–µ–º–∞—î –¥—Ä—É–∑—ñ–≤.</p>
                </ul>
            </div>

            <div id="incoming-requests-tab" class="tab-content">
                <ul id="incoming-requests-list" class="user-list">
                    <p class="empty-list-placeholder" data-i18n="friends_incoming_empty">–ù–µ–º–∞—î –≤—Ö—ñ–¥–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤.</p>
                </ul>
            </div>

            <div id="outgoing-requests-tab" class="tab-content">
                <ul id="outgoing-requests-list" class="user-list">
                    <p class="empty-list-placeholder" data-i18n="friends_outgoing_empty">–ù–µ–º–∞—î –≤–∏—Ö—ñ–¥–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤.</p>
                </ul>
            </div>

            <div id="add-friend-tab" class="tab-content">
                <div class="search-form">
                    <input type="text" id="find-friend-input" data-i18n-placeholder="friends_search_placeholder">
                    <button id="find-friend-btn" data-i18n="friends_search_button">–ü–æ—à—É–∫</button>
                </div>
                <div id="search-results-container">
                    <ul id="search-results-list" class="user-list"></ul>
                    <p id="search-message" class="info-message"></p>
                </div>
            </div>
        </div>
    </div>

    <div id="game-invite-toast" class="modal-overlay" style="display: none;">
        <div class="modal-content invite-modal">
            <h3 id="invite-title">–ó–∞–ø—Ä–æ—à–µ–Ω–Ω—è –≤ –≥—Ä—É</h3>
            <p id="invite-text">–ì—Ä–∞–≤–µ—Ü—å <strong>PlayerName</strong> –∑–∞–ø—Ä–æ—à—É—î –≤–∞—Å –ø—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –¥–æ –≥—Ä–∏!</p>
            <div class="invite-actions">
                <button id="accept-invite-btn" class="primary">–ü—Ä–∏–π–Ω—è—Ç–∏</button>
                <button id="decline-invite-btn" class="secondary">–í—ñ–¥—Ö–∏–ª–∏—Ç–∏</button>
            </div>
        </div>
    </div>


    <div id="achievement-toast-container"></div>
    <div id="youtube-player-container" style="position: absolute; top: -9999px; left: -9999px;"></div>

    <script src="js/i18n.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="js/friends.js"></script>
    <script src="js/client.js"></script>
    <script src="https://www.youtube.com/iframe_api"></script>
</body>

</html>